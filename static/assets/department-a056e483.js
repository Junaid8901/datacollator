import{r as s,H as pe,K as i,L as e,a1 as ue,B as je,a7 as Le,V as y,a2 as N,a6 as P,af as le}from"./index-2d311879.js";import{A as Te}from"./react-paginate-21a7ab7f.js";import{C as he}from"./Card-0873846d.js";import{C as W}from"./CardBody-4add9265.js";import{M as Me,j as Pe,k as Ae,F as S,I as j,m as Y,C as A,n as ie,b as Z,X as Fe,S as Ie,o as Oe}from"./App-2483e876.js";import{T as Be}from"./Table-424cb917.js";import{S as Re,P as Ee}from"./Pagination-0da0c60d.js";import{U as He}from"./index-bcb40917.js";import{T as Ue}from"./TooltipControl-6ccc75fc.js";import{L as ze}from"./Label-a41942c5.js";/* empty css                  */import{D as U}from"./DealerAdminButton-4fadf9af.js";import"./SearchField-14e7ba37.js";import{a as C}from"./ToastComponent-231ab741.js";import{M as qe}from"./ModalForDelete-e2812b3d.js";import{q as x}from"./index-fe8611b3.js";import{R as Ve}from"./Row-baaf3703.js";import{C as k}from"./Col-e0c46088.js";import{F as Ge}from"./Form-214e9b0e.js";import{P as Ke}from"./ProjectModel-50ae6cc7.js";import"./Alert-95e83888.js";import"./index-ff7c4dc5.js";import"./SingleAsyncPagination-dc3f178b.js";const Xe=({open:p,handleModal:m,detail:f,setDetail:l,updateAble:F,setUpdateAble:b,getUnderWriter:I,handleChangeSelect:$})=>{const[L,r]=s.useState(!1),[z,d]=s.useState([]);pe();const O=()=>{l(_=>({..._,active:!_.active}))},K=_=>{_.preventDefault(),r(!0);const g={...f};Le.is_super_admin||delete g.external_admin,y.post(`${N}/api/department/`,g,P).then(h=>{r(!1),I(),m(),C("success",A,"Successfully added")}).catch(h=>{if(r(!1),h&&h.response.status===400)for(const[w,o]of Object.entries(h.response.data))d(V=>V.concat(w)),C("error",Z,`${ie(w)}: ${o}`)})},X=_=>{d([]),_.preventDefault(),r(!0);const g={...f};y.put(`${N}/api/department/${f.id}/`,g,P).then(h=>{r(!1),m(),I(),C("success",A,"Successfully updated"),setTimeout(()=>{window.location.reload()},1e3)}).catch(h=>{if(r(!1),h&&h.response.status===400)for(const[w,o]of Object.entries(h.response.data))d(V=>V.concat(w)),C("error",Z,`${ie(w)}: ${o}`)})};s.useEffect(()=>{},[]);const B=()=>{l({name:""}),b(!1),b(!1),d([])},q=_=>g=>{d([]),l({...f,[_]:g.target.value})};return i(Me,{isOpen:p,onClosed:B,toggle:m,className:"sidebar-lg",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e(Pe,{className:"mb-1",toggle:m,close:e(Fe,{className:"cursor-pointer",size:15,onClick:m}),tag:"div",children:e("h5",{className:"modal-title",children:F?"Update Department":"Add New Department"})}),i(Ae,{className:"flex-grow-1",children:[i(S,{children:[e(ze,{for:"name",children:"Department Name"}),e(j,{invalid:z.includes("name"),id:"name",placeholder:"Name",value:f.name,onChange:q("name")})]}),e(S,{children:e(Y,{checked:f.active,type:"checkbox",label:"Active",id:"select-all",onChange:()=>O()})}),i(U,{className:"mr-1",color:"primary",disabled:L,onClick:F?X:K,children:[F?"Update":"Submit"," ",L&&e(ue,{color:"light",size:"sm"})]}),e(je,{color:"secondary",onClick:m,outline:!0,disabled:L,children:"Cancel"})]})]})};function Je({checkType:p,userType:m,setSearchParams:f,searchParams:l,memberArrange:F,searching:b,handleList:I,children:$,handleChangeSelectDbType:L}){const r=d=>O=>{f({...l,[d]:O.target.value})},z=d=>{d.preventDefault(),I(1,!0,"search")};return e(s.Fragment,{children:e(he,{children:e(W,{children:e(Ge,{onSubmit:d=>z(d),children:i(Ve,{children:[e(k,{md:"3",children:e(S,{children:e(j,{placeholder:"cluster id",onChange:r("cluster_id"),value:l.cluster_id})})}),e(k,{md:"3",children:e(S,{children:e(j,{placeholder:"pcd refset id",onChange:r("pcd_refset_id"),value:l.pcd_refset_id})})}),e(k,{md:"3",children:e(S,{children:e(j,{placeholder:"ruleset_id",onChange:r("ruleset_id"),value:l.ruleset_id})})}),e(k,{md:"3",children:e(S,{children:e(j,{placeholder:"cluster_description",onChange:r("cluster_description"),value:l.cluster_description})})}),e(k,{md:"3",children:e(S,{children:e(j,{type:"number",placeholder:"snomed_code",onChange:r("snomed_code"),value:l.snomed_code})})}),e(k,{md:"3",children:e(S,{children:e(j,{placeholder:"snomed_code_description",onChange:r("snomed_code_description"),value:l.snomed_code_description})})}),e(k,{md:"3",children:e(S,{children:e(j,{placeholder:"output id",onChange:r("output_id"),value:l.output_id})})}),e(k,{md:"3",children:i(S,{children:[i(U,{outline:!0,type:"submit",disabled:b,children:[b?e(ue,{size:"sm"}):e(Ie,{size:15})," ","Search"]}),$]})})]})})})})})}function xt(){const[p,m]=s.useState([]),[f,l]=s.useState([]),[F,b]=s.useState(!1),[I,$]=s.useState(!1),[L,r]=s.useState(!1),[z,d]=s.useState(!1),[O,K]=s.useState(""),[X,B]=s.useState(!1),[q,J]=s.useState(!1),[_,g]=s.useState([]),[h,w]=s.useState(!1),[o,V]=s.useState([]),[ee,Qe]=s.useState(!1),[v,We]=s.useState([]),[u,R]=s.useState(!1),[me,T]=s.useState(!1),[M,te]=s.useState(1),[fe,se]=s.useState(),[D,H]=s.useState({name:"",project_name:" "}),[Ye,ae]=s.useState([]);s.useState(1),s.useState(1),s.useState(!1),s.useState(!0),s.useState("");const[n,ce]=s.useState({page:x("page"),cluster_id:x("cluster_id"),pcd_refset_id:x("pcd_refset_id"),ruleset_id:x("ruleset_id"),snomed_code:x("snomed_code"),db_type:x("db_type"),snomed_code_description:x("snomed_code_description"),cluster_description:x("cluster_description"),output_id:x("output_id")}),[_e,Q]=s.useState({name:"",active:!1}),ge=t=>(console.log("page",n),`${`&cluster_id=${n.cluster_id?n.cluster_id:""}`}${`&pcd_refset_id=${n.pcd_refset_id?n.pcd_refset_id:""}`}${`&ruleset_id=${n.ruleset_id?n.ruleset_id:""}`}${`&snomed_code=${n.snomed_code?n.snomed_code:""}`}${`&db_type=${n.db_type?n.db_type:""}`}${`&snomed_code_description=${n.snomed_code_description?n.snomed_code_description:""}`}${`&cluster_description=${n.cluster_description?n.cluster_description:""}`}${`&output_id=${n.output_id?n.output_id:""}`}`),Se=t=>a=>{H({...D,[t]:a.target.value})},Ce=t=>a=>{ce({...n,[t]:a});const c=err.filter(E=>E!==t);setErr(c)};pe();const oe=(t,a)=>{g(a),$(!0),y.get(`${N}/api/pcdrefset/?page=${M}`,P).then(c=>{console.log("navigationData",c),$(!1),m(c.data.results),g(c.data.results[0].db_type),b(!0),B(!1),G()}).catch(c=>{b(!0),$(!1),te(E=>E-1)})},G=t=>{te(t),$(!0),y.get(`${N}/api/pcdrefset/?page=${t||1}${ge()}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${le}`}}).then(a=>{$(!1),m(a.data.results),l(a.data),g(a.data.results[0].db_type),b(!0),B(!1),ae([]);for(let c=0;c<a.data.total_pages;++c)ae(E=>E.concat(c+1))}).catch(()=>{$(!1)})};s.useEffect(()=>{G()},[]);const be=t=>{Q({id:t}),d(!0),y.get(`${N}/api/department/${t}/`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${le}`}}).then(a=>{d(!1),Q({...a.data}),r(!L),B(!0)}).catch(()=>{d(!1)})},$e=()=>{w(!0),y.delete(`${N}/api/department/${O}/`,P).then(t=>{C("error",Z,"Successfully Deleted"),J(!q),w(!1),oe()})},xe=t=>e(s.Fragment,{children:e(Ue,{target:`detail-${t.id}`,Icon:Oe,title:"Detail",navLink:`/detail/${_}/${t.id}`})}),ne=(t,a)=>{H({...D,[t]:a})},re=()=>{console.log("selectedRows",o);const t={pcd_ids:o,source:"pcd_data"};y.post(`${N}/api/exported/`,t,P).then(a=>{C("success",A,"Successfully export")}).catch(a=>{})},ye=()=>{T(!0),se(1)},Ne=()=>{T(!0),se(2)},we=()=>{if(T(!0),console.log("selectedRows",o),!D.name)C("error",A,"Enter project name");else{const t={pcd_refsets:o,project_name:D.name};y.post(`${N}/api/pcd-projects/`,t,P).then(a=>{T(!1),C("success",A,"Successfully create"),H({...D,name:""})}).catch(a=>{})}},ve=()=>{T(!0);const t={pcd_refsets:o},a=D.project_name.id;console.log("selectedRows",a),a?y.put(`${N}/api/pcd-projects/${a}/`,t,P).then(c=>{T(!1),H({...D,project_name:""}),C("success",A,"Successfully update")}).catch(c=>{}):C("error",A,"select project ")};s.useEffect(()=>{},[]);const De=()=>{const t=[],a=[];if(v.includes(M)){v.splice(v.indexOf(M),1);for(let c=0;c<p.length;c++)a.push(parseFloat(p[c].amount)),o.splice(o.indexOf(p[c].id),1);R({...u,tester:u}),subAllHandler(a),R({...u,tester:u})}else{v.push(M);for(let c=0;c<p.length;c++)o.includes(p[c].id)||(t.push(parseFloat(p[c].amount)),o.push(p[c].id));R({...u,tester:u}),R({...u,tester:u})}},ke=(t,a,c)=>{t.target.checked?(o.push(a),R({...u,tester:u})):(o.splice(o.indexOf(a),1),v.includes(M)&&v.splice(v.indexOf(M),1),R({...u,tester:u}))},de=t=>{const a=t.length>70?`${t.slice(0,70)}.......`:t;return a.slice(9),a};return i(s.Fragment,{children:[e(Je,{setSearchParams:ce,searchParams:n,searching:ee,handleList:G,handleChangeSelectDbType:Ce}),i(he,{children:[i("div",{className:"d-flex align-items-center justify-content-between p-1",children:[e("div",{children:e("h3",{className:"m-0",children:"Pcd Data "})}),i("div",{children:[e(U,{onClick:ye,disabled:o.length===0,children:"Create Project"})," ",e(U,{onClick:Ne,disabled:o.length===0,children:"Update Project"})," ",e(U,{onClick:re,disabled:o.length===0,children:"Export"})]})]}),F?e(He,{blocking:I,children:p.length?i(Be,{responsive:!0,children:[e("thead",{children:i("tr",{children:[e("th",{className:"text-nowrap",children:e(Y,{type:"checkbox",id:"invoice-select-all",label:"",checked:v.includes(M),onChange:t=>De()})}),e("th",{scope:"col",className:"text-nowrap",children:"id"})," ",e("th",{scope:"col",className:"text-nowrap w",children:"db type "})," ",e("th",{scope:"col",className:"text-nowrap",children:"cluster id"}),e("th",{scope:"col",className:"text-nowrap",children:"snomed code"}),e("th",{scope:"col",className:"text-nowrap",children:"Output id"}),e("th",{scope:"col",className:"text-nowrap",children:"output description"}),e("th",{scope:"col",className:"text-nowrap",children:"pcd refset id"}),e("th",{scope:"col",className:"text-nowrap",children:"cluster description "}),e("th",{scope:"col",className:"text-nowrap",children:"snomed code description"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:p.map((t,a)=>i("tr",{children:[e("th",{children:e(Y,{type:"checkbox",id:`department-${t.id}-${a}`,checked:o.includes(t.id),onChange:c=>ke(c,t.id),disabled:""})}),e("td",{className:"text-nowrap cursor-pointer",children:t.id?t.id:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.db_type!==null?t.db_type:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.cluster_id?t.cluster_id:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code?t.snomed_code:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.output_id?t.output_id:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.output_description?t.output_description:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.pcd_refset_id!==null?t.pcd_refset_id:"---"}),e("td",{className:"text-nowrap cursor-pointer ",children:t.cluster_description?de(t.cluster_description):"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code_description?de(t.snomed_code_description):"---"}),e("td",{className:"text-right",onClick:()=>K(t.id),children:xe(t)})]},a))})]}):e(W,{children:e(Te,{color:"danger",msg:"No results found!"})})}):e(W,{children:e(Re,{})}),p.length>1&&e(Ee,{pages:f,action:G,disabled:ee})]}),e(Xe,{handleChangeSelect:ne,open:L,handleModal:re,getData:be,getPcdData:oe,detail:_e,setDetail:Q,updateAble:X,setUpdateAble:B,dId:O}),e(Ke,{open:me,setOpen:T,handleChange:Se,setValue:H,value:D,CreateProjectHandleModal:we,UpdateProjectHandleModal:ve,handleChangeSelect:ne,selectProject:fe}),e(qe,{isLoading:h,centeredModal:q,setCenteredModal:J,onDelete:()=>$e()})]})}export{xt as default};
