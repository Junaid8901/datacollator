import{K as e,J as c,a1 as U,ak as V,a0 as be,r as l,a9 as ne,U as re,a5 as te,aa as q}from"./index-67acb5a9.js";import{R as ge}from"./Row-cc16094e.js";import{C as o}from"./Col-9f6d0d1a.js";import{C as _e}from"./Card-4fea091a.js";import{C as G}from"./CardBody-73830640.js";import{F as ve}from"./Form-f3b7866a.js";import{z as Se,F as i,K as $,Z as le,$ as x,a0 as F,a1 as Ce,a2 as J,a3 as we,a4 as Ne,a5 as $e,S as xe,P as ce,u as Fe,a6 as ae,U as Me,a7 as Ue,Y as De,V as Ie,I as Be,R as Oe}from"./App-ce653d86.js";import{I as _}from"./Input-55b2ccf9.js";import{S as M}from"./SearchField-51ca94a5.js";import{D as Re}from"./DealerAdminButton-7238082e.js";/* empty css                  */import{F as oe}from"./index-7b3e37e4.js";import{f as ie,d as Ae}from"./getCalenderData-9836b40c.js";import{a as se}from"./apiStarts-fd3ecf19.js";import{A as ke}from"./AppCard-bb24aa62.js";import{T as Le}from"./Table-63808cde.js";import{S as ze,P as Te}from"./Pagination-e1d74c4b.js";import{A as Ee}from"./AlertComponent-a4438a5a.js";import{d as de}from"./TooltipControl-9379d2bb.js";import{M as He}from"./ModalForDelete-298e5394.js";import{a as Ke}from"./ToastComponent-252645f5.js";import{U as je}from"./index-9933d28c.js";import"./index-a489c0fd.js";import"./moment-fbc5633a.js";import"./CardTitle-5ac35081.js";import"./react-paginate-f55c1d30.js";import"./Alert-da2d672f.js";function Ve({searchParam:n,setSearchParam:d,handleList:m,isLoading:D,searchByName:h,searchByDealerNumber:O,searchByDealer:R,searchByModelGroup:Q,searchByUnderwritter:A,searchByVehicleType:Y,searchByReinsurance:v,isDataLoaded:y,showWarning:S,searchBySR:k,searchByAgent:I,searchByMemberType:b,searchBymemberOf:Z,searchByAdmin:L,remitType:p,searchByDealerMember:B,disabled:z,searchByStartDate:T,searchByEndDate:E,searchByMinPaid:g,searchByMaxPaid:H,searchByRecieptNumber:K,searchByCustomerType:a,searchByMember:u,mem:C,children:me,namePlaceholder:W,searchByDealerUnderwriter:pe,searchByModel:Je,isClearable:j,payable:Qe,memberOf:ue,searchByMoneyMovemenet:he,searchByClipType:fe}){const t=Se(p),ye=r=>{r.preventDefault(),m(!0,1)},f=r=>s=>{d({...n,[r]:s.target.value})},w=(r,s)=>{d({...n,[s]:r})},X=(r,s)=>{d(s==="underwriter"||s==="reinsurance"?{...n,[s]:r,dealer:""}:{...n,[s]:r})},P=r=>s=>{const ee=s[0];console.log("date",ee),n[r]=Ae(ee)},N=(r,s)=>{console.log("searchParam.member_type",n.member_type),console.log("e",r,"name",s),d({...n,[s]:r||"",overfund:"",misc_overfund:""})};return e(_e,{children:e(G,{children:e(ve,{onSubmit:r=>ye(r),children:c(ge,{children:[h&&e(o,{md:"3",children:e(i,{children:e(_,{type:"search",value:n.name,onChange:f("name"),placeholder:`Search by ${W||"name"}`,id:"search-by-name"})})}),O&&e(o,{md:"3",children:e(i,{children:e(_,{type:"search",value:n.dealer_number,onChange:f("dealer_number"),placeholder:"Search by dealer number",id:"search-by-dealer-number"})})}),T&&e(o,{md:"3",children:e(i,{children:e(oe,{onBlur:f("date_start"),placeholder:"From date",className:"form-control",value:n.date_start,onChange:P("date_start"),options:ie})})}),E&&e(o,{md:"3",children:e(i,{children:e(oe,{onBlur:f("date_end"),value:n.date_end,placeholder:"To date",className:"form-control",onChange:P("date_end"),options:ie})})}),g&&e(o,{md:"3",children:e(i,{children:e(_,{type:"search",id:"search-by-min-paid",placeholder:"Min paid",onChange:f("min_paid_amount"),value:n.min_paid_amount})})}),H&&e(o,{md:"3",children:e(i,{children:e(_,{type:"search",id:"search-by-max-paid",placeholder:"Max paid",onChange:f("max_paid_amount"),value:n.max_paid_amount})})}),K&&e(o,{md:"3",children:e(i,{children:e(_,{type:"search",id:"search-by-receipt-number",placeholder:"Receipt number",onChange:f("id"),value:n.od})})}),b&&e(o,{md:"3",children:e(i,{children:e($,{placeholder:"Member type",id:"search-by-member-type",value:{label:n.member_type==="Dealer"?"Policy Holder":n.member_type&&n.member_type==="Underwriter"?"Insurance company":n.member_type},options:p==="misc-overfund"?[...le,"Underwriter","Reinsurance"]:le,theme:x,className:"react-select",classNamePrefix:"select",isClearable:!1,isSearchable:!1,onChange:r=>N(r,"member_type"),components:{Option:F}})})}),a&&e(o,{md:"3",children:e(i,{children:e($,{placeholder:"Member type",id:"search-by-member-type",value:{label:n.customer_of},options:Ce,theme:x,className:"react-select",classNamePrefix:"select",isClearable:!1,isSearchable:!1,onChange:r=>N(r,"customer_of"),components:{Option:F}})})}),R&&e(o,{md:"3",children:e(i,{children:e(M,{getEmail:!0,value:n[t||"dealer"],childUrl:`${se}dealer/`,parentFunction:w,placeholder:"Policy holder",name:t||"dealer",isClearable:!j})})}),ue&&e(o,{md:"3",children:e(_,{disabled:!0,placeholder:"Select memeber of"})}),Q&&e(o,{md:"3",children:e(i,{children:e(M,{value:n.model_group,childUrl:`${U}/api/company/${V}/model/group/`,parentFunction:w,placeholder:"Model group",name:"model_group"})})}),A&&e(o,{md:"3",children:e(i,{children:e(M,{value:n[t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"underwriter"],childUrl:`${U}/api/company/${V}/underwriter/`,parentFunction:p==="underwriter"?X:w,isClearable:p&&!j,placeholder:t==="misc_overfund"?"Select Insurance company":"Insurance company",warningClass:S&&!y,name:t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"underwriter"})})}),v&&e(o,{md:"3",children:e(i,{children:e(M,{value:n[t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"reinsurance"],childUrl:`${U}/api/company/${V}/reinsurance/`,parentFunction:p==="reinsurance"?X:w,isClearable:p&&!j,placeholder:t==="misc_overfund"?"Select reinsurance":"Reinsurance",name:t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"reinsurance",warningClass:S&&!y})})}),pe&&e(o,{md:"6",children:e(i,{children:e(M,{reload:n.underwriter||n.reinsurance,value:n.dealer,childUrl:`${se}dealer/`,parentFunction:w,placeholder:J("Dealer"),showWarning:S,name:"dealer",multi:!0,underwriter:t==="underwriter",reinsurance:t==="reinsurance",reinsuranceId:n.reinsurance?n.reinsurance.id:"",underwriterId:n.underwriter?n.underwriter.id:""})})}),Y&&e(o,{md:"3",children:e(i,{children:e($,{placeholder:"Vehicle type",id:"search-by-vehicle-type",value:{label:n.vehicle_type?n.vehicle_type:"Select vehicle type"},options:we,theme:x,className:"react-select",classNamePrefix:"select",isClearable:!0,isSearchable:!1,onChange:r=>N(r,"vehicle_type"),components:{Option:F}})})}),he&&e(o,{md:"3",children:e(i,{children:e($,{placeholder:"Money movement enabled",id:"search-by-enable-money-movement",value:{label:n.enable_money_movement?n.enable_money_movement:"Select money movement enabled"},options:Ne,theme:x,className:"react-select",classNamePrefix:"select",isClearable:!0,isSearchable:!1,onChange:r=>N(r,"enable_money_movement"),components:{Option:F}})})}),fe&&e(o,{md:"3",children:e(i,{children:e($,{placeholder:"Clip type",id:"search-by-clip-type",value:{label:n.clip_type?n.clip_type:"Select clip type"},options:$e,theme:x,className:"react-select",classNamePrefix:"select",isClearable:!0,isSearchable:!1,onChange:r=>N(r,"clip_type"),components:{Option:F}})})}),c(o,{md:"3",children:[c(Re,{type:"submit",id:"search-btn",outline:!0,disabled:D||z,children:[D?e(be,{size:"sm"}):e(xe,{size:15})," ","Search"]}),me]})]})})})})}function qe(){const{roleType:n}=ce(),d=Fe(),[m,D]=l.useState({page:1,name:""}),[h,O]=l.useState("");l.useState(!1);const[R,Q]=l.useState(!1),[A,Y]=l.useState(!1),[v,y]=l.useState(!1),[S,k]=l.useState(!1);l.useState(""),l.useState([]),l.useState(""),l.useState(!1),l.useState(!1);const[I,b]=l.useState(!1),[Z,L]=l.useState(!1);l.useState([]);const[p,B]=l.useState(!1),z=()=>{d.push(`/${n}-roles/add`)},T=()=>`${U}/api/role/`,E=a=>`?page=${a||m.page}${m.name&&`&name=${m.name}`}`,g=(a,u)=>{a?b(!0):a&&u?(b(!0),setQueryParams({...queryParams,page:u})):!a&&!u&&B(!1),re.get(T()+E(u),te).then(C=>{console.log("res",C),O(C.data),b(!1),B(!0)}).catch(C=>{console.log("e",C),b(!1),B(!0)})},H=a=>c(l.Fragment,{children:[e(l.Fragment,{children:R&&A.id===a?e(Spinner,{size:"sm",color:"primary",className:"ml-1"}):e(de,{target:`edit-${a}`,Icon:De,title:"Edit",action:()=>{d.push(`/${n}-roles/edit/${a}`)}})}),e(de,{target:`delete-${a}`,Icon:Ie,title:"Delete",action:()=>{k(a),y(!v)}})]}),K=a=>{L(!0),re.delete(`${U}/api/role/${S}/`,te).then(u=>{Ke("error",Be,"Successfully deleted"),y(!v),g(),L(!1)})};return l.useEffect(()=>{g()},[window.location.href]),c(l.Fragment,{children:[e(Ve,{searchByName:!0,searchParam:m,setSearchParam:D,handleList:g,isLoading:I}),e(ke,{title:`${J(n)} roles`,button:`${J(n)} roles`,onClick:()=>z(),children:p?e(l.Fragment,{children:h&&h.results.length?c(l.Fragment,{children:[e(je,{blocking:I,children:c(Le,{responsive:!0,children:[e("thead",{children:c("tr",{children:[e("th",{scope:"col",className:"text-nowrap",children:"id"}),e("th",{scope:"col",className:"text-nowrap",children:"Name"}),e("th",{scope:"col",className:"text-nowrap",children:"Permissions"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:h.results.map((a,u)=>c("tr",{children:[e("td",{className:"text-nowrap",children:ae(a.id)}),c("td",{className:"text-nowrap",children:[e(ne,{pill:!0,color:"light-primary",children:e(Me,{size:20})})," ",ae(a.name)]}),c("td",{className:"text-nowrap",children:[e(ne,{pill:!0,color:"light-success",children:e(Ue,{size:20})})," ",a.permissions]}),e("td",{className:"text-right",onClick:()=>k(a.id),children:H(a.id)})]},u))})]})}),h.total_pages>1&&e(Te,{action:g,pages:h,disabled:I})]}):e(G,{children:e(Ee,{color:"danger",msg:"No results found!"})})}):e(G,{children:e(ze,{})})}),e(He,{isLoading:Z,centeredModal:v,setCenteredModal:y,onDelete:()=>K()})]})}function Ge({children:n,permission:d}){const m=()=>q?q&&q.includes(d)?n:e(Oe,{to:"/misc/not-authorized"}):n;return e(l.Fragment,{children:m()})}function wn(){const{roleType:n}=ce(),d=()=>{if(n==="administrator")return"view_companyrole"};return e(l.Fragment,{children:e(Ge,{permission:d(),children:e(qe,{})})})}export{wn as default};
