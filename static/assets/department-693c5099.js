import{r as s,H as le,K as i,L as e,a1 as ie,B as $e,a7 as ye,V as w,a2 as v,a6 as R,ah as re}from"./index-3d883fcf.js";import{A as Ne}from"./AlertComponent-bf42c7e0.js";import{C as pe}from"./Card-592ff91e.js";import{C as K}from"./CardBody-936a8236.js";import{M as we,o as ve,p as De,F as S,I as L,i as V,D as Q,C as X,q as de,b as J,X as Le,S as ke,r as Ie,s as Te,O as Ae,t as Oe,k as Fe,v as Be,w as Me}from"./App-5cbcf20f.js";import{T as Ee}from"./Table-3067e42e.js";import{S as je,P as Re}from"./Pagination-d99299e9.js";import{T as Ue}from"./TooltipControl-b72a6e51.js";import{L as ze}from"./Label-80144cb0.js";import{a as M}from"./ToastComponent-8641b054.js";import{q as y}from"./index-462ac6f0.js";import{R as He}from"./Row-5109e405.js";import{C as N}from"./Col-a2b04bb3.js";import{F as Pe}from"./Form-3f6d3038.js";import"./Alert-a7a9f3c0.js";const qe=({open:c,handleModal:f,detail:_,setDetail:r,updateAble:k,setUpdateAble:b,getUnderWriter:E,handleChangeSelect:I})=>{const[T,d]=s.useState(!1),[U,l]=s.useState([]);le();const j=()=>{r(u=>({...u,active:!u.active}))},C=u=>{u.preventDefault(),d(!0);const x={..._};ye.is_super_admin||delete x.external_admin,w.post(`${v}/api/department/`,x,R).then(h=>{d(!1),E(),f(),M("success",X,"Successfully added")}).catch(h=>{if(d(!1),h&&h.response.status===400)for(const[g,A]of Object.entries(h.response.data))l(O=>O.concat(g)),M("error",J,`${de(g)}: ${A}`)})},z=u=>{l([]),u.preventDefault(),d(!0);const x={..._};w.put(`${v}/api/department/${_.id}/`,x,R).then(h=>{d(!1),f(),E(),M("success",X,"Successfully updated"),setTimeout(()=>{window.location.reload()},1e3)}).catch(h=>{if(d(!1),h&&h.response.status===400)for(const[g,A]of Object.entries(h.response.data))l(O=>O.concat(g)),M("error",J,`${de(g)}: ${A}`)})};s.useEffect(()=>{},[]);const W=()=>{r({name:""}),b(!1),b(!1),l([])},Y=u=>x=>{l([]),r({..._,[u]:x.target.value})};return i(we,{isOpen:c,onClosed:W,toggle:f,className:"sidebar-lg",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e(ve,{className:"mb-1",toggle:f,close:e(Le,{className:"cursor-pointer",size:15,onClick:f}),tag:"div",children:e("h5",{className:"modal-title",children:k?"Update Department":"Add New Department"})}),i(De,{className:"flex-grow-1",children:[i(S,{children:[e(ze,{for:"name",children:"Department Name"}),e(L,{invalid:U.includes("name"),id:"name",placeholder:"Name",value:_.name,onChange:Y("name")})]}),e(S,{children:e(V,{checked:_.active,type:"checkbox",label:"Active",id:"select-all",onChange:()=>j()})}),i(Q,{className:"mr-1",color:"primary",disabled:T,onClick:k?z:C,children:[k?"Update":"Submit"," ",T&&e(ie,{color:"light",size:"sm"})]}),e($e,{color:"secondary",onClick:f,outline:!0,disabled:T,children:"Cancel"})]})]})};function We({checkType:c,userType:f,setSearchParams:_,searchParams:r,memberArrange:k,searching:b,handleList:E,children:I,handleChangeSelectDbType:T}){const d=l=>j=>{_({...r,[l]:j.target.value})},U=l=>{l.preventDefault(),E(1,!0,"search")};return e(s.Fragment,{children:e(pe,{children:e(K,{children:e(Pe,{onSubmit:l=>U(l),children:i(He,{children:[e(N,{md:"3",children:e(S,{children:e(L,{placeholder:"cluster id",onChange:d("cluster_id"),value:r.cluster_id})})}),e(N,{md:"3",children:e(S,{children:e(L,{placeholder:"pcd refset id",onChange:d("pcd_refset_id"),value:r.pcd_refset_id})})}),e(N,{md:"3",children:e(S,{children:e(L,{placeholder:"ruleset_id",onChange:d("ruleset_id"),value:r.ruleset_id})})}),e(N,{md:"3",children:e(S,{children:e(L,{placeholder:"cluster_description",onChange:d("cluster_description"),value:r.cluster_description})})}),e(N,{md:"3",children:e(S,{children:e(L,{type:"number",placeholder:"snomed_code",onChange:d("snomed_code"),value:r.snomed_code})})}),e(N,{md:"3",children:e(S,{children:e(L,{placeholder:"snomed_code_description",onChange:d("snomed_code_description"),value:r.snomed_code_description})})}),e(N,{md:"3",children:e(S,{children:e(ke,{id:"label",value:{label:r.db_type?r.db_type:"Select db type"},options:Ie,theme:Te,className:"react-select",classNamePrefix:"select",isClearable:!0,onChange:T("db_type"),components:{Option:Ae}})})}),e(N,{md:"3",children:i(S,{children:[i(Q,{outline:!0,type:"submit",disabled:b,children:[b?e(ie,{size:"sm"}):e(Oe,{size:15})," ","Search"]}),I]})})]})})})})})}function pt(){const[c,f]=s.useState([]),[_,r]=s.useState([]),[k,b]=s.useState(!1),[E,I]=s.useState(!1),[T,d]=s.useState(!1),[U,l]=s.useState(!1),[j,C]=s.useState(!1),[z,W]=s.useState(!1),[Y,H]=s.useState(!1),[u,x]=s.useState(""),[h,g]=s.useState(!1),[A,O]=s.useState(!1),[ue,G]=s.useState([]),[he,Z]=s.useState(!1),[m,Ge]=s.useState([]),[ee,Ke]=s.useState(!1),[$,Ve]=s.useState([]),[p,F]=s.useState(!1),[D,te]=s.useState(1),[Xe,se]=s.useState([]);s.useState(1),s.useState(1),s.useState(!1),s.useState(!0),s.useState("");const[o,ae]=s.useState({page:y("page"),cluster_id:y("cluster_id"),pcd_refset_id:y("pcd_refset_id"),ruleset_id:y("ruleset_id"),snomed_code:y("snomed_code"),db_type:y("db_type"),snomed_code_description:y("snomed_code_description"),cluster_description:y("cluster_description")}),[ne,P]=s.useState({name:"",active:!1}),me=t=>(console.log("page",o),`${`&cluster_id=${o.cluster_id?o.cluster_id:""}`}${`&pcd_refset_id=${o.pcd_refset_id?o.pcd_refset_id:""}`}${`&ruleset_id=${o.ruleset_id?o.ruleset_id:""}`}${`&snomed_code=${o.snomed_code?o.snomed_code:""}`}${`&db_type=${o.db_type?o.db_type:""}`}${`&snomed_code_description=${o.snomed_code_description?o.snomed_code_description:""}`}${`&cluster_description=${o.cluster_description?o.cluster_description:""}`}`),fe=t=>a=>{ae({...o,[t]:a});const n=err.filter(B=>B!==t);setErr(n)};le();const ce=(t,a)=>{t&&a==="Content"&&I(!0),t&&a==="Content_By_Output"&&d(!0),t&&a==="Output_Description"&&l(!0),G(a),C(!0),w.get(`${v}/api/pcdrefset/?page=${D}`,R).then(n=>{console.log("navigationData",n),C(!1),f(n.data.results),G(n.data.results[0].db_type),b(!0),g(!1),q()}).catch(n=>{b(!0),C(!1),te(B=>B-1)})},q=t=>{te(t),C(!0),w.get(`${v}/api/pcdrefset/?page=${t||1}${me()}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${re}`}}).then(a=>{I(!1),C(!1),f(a.data.results),r(a.data),G(a.data.results[0].db_type),b(!0),g(!1),se([]);for(let n=0;n<a.data.total_pages;++n)se(B=>B.concat(n+1))}).catch(()=>{I(!1),C(!1)})};s.useEffect(()=>{q()},[]);const _e=t=>{P({id:t}),H(!0),w.get(`${v}/api/department/${t}/`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${re}`}}).then(a=>{H(!1),P({...a.data}),W(!z),g(!0)}).catch(()=>{H(!1)})},ge=()=>{Z(!0),w.delete(`${v}/api/department/${u}/`,R).then(t=>{M("error",J,"Successfully Deleted"),O(!A),Z(!1),ce()})},Se=t=>e(s.Fragment,{children:e(Ue,{target:`detail-${t.id}`,Icon:Me,title:"Detail",navLink:`/detail/${ue}/${t.id}`})}),be=(t,a)=>{P({...ne,[t]:a})},oe=()=>{console.log("selectedRows",m);const t={pcd_ids:m};w.post(`${v}/api/exported/`,t,R).then(a=>{M("success",X,"Successfully export")}).catch(a=>{})};s.useEffect(()=>{},[]);const Ce=()=>{const t=[],a=[];if($.includes(D)){$.splice($.indexOf(D),1);for(let n=0;n<c.length;n++)a.push(parseFloat(c[n].amount)),m.splice(m.indexOf(c[n].id),1);F({...p,tester:p}),subAllHandler(a),F({...p,tester:p})}else{$.push(D);for(let n=0;n<c.length;n++)m.includes(c[n].id)||(t.push(parseFloat(c[n].amount)),m.push(c[n].id));F({...p,tester:p}),F({...p,tester:p})}},xe=(t,a,n)=>{t.target.checked?(m.push(a),F({...p,tester:p})):(m.splice(m.indexOf(a),1),$.includes(D)&&$.splice($.indexOf(D),1),F({...p,tester:p}))};return i(s.Fragment,{children:[e(We,{setSearchParams:ae,searchParams:o,searching:ee,handleList:q,handleChangeSelectDbType:fe}),i(pe,{children:[i("div",{className:"d-flex align-items-center justify-content-between p-1",children:[e("div",{children:e("h3",{className:"m-0",children:"Pcd Data "})}),e("div",{children:e(Q,{onClick:oe,disabled:m.length===0,children:"Export"})})]}),k?e(Fe,{blocking:j,children:c.length?i(Ee,{responsive:!0,children:[e("thead",{children:i("tr",{children:[e("th",{className:"text-nowrap",children:e(V,{type:"checkbox",id:"invoice-select-all",label:"",checked:$.includes(D),onChange:t=>Ce()})}),e("th",{scope:"col",className:"text-nowrap",children:"id"})," ",e("th",{scope:"col",className:"text-nowrap w",children:"db type "})," ",e("th",{scope:"col",className:"text-nowrap",children:"cluster id"}),e("th",{scope:"col",className:"text-nowrap",children:"snomed code"}),e("th",{scope:"col",className:"text-nowrap",children:"Output id"}),e("th",{scope:"col",className:"text-nowrap",children:"output description"}),e("th",{scope:"col",className:"text-nowrap",children:"pcd refset id"}),e("th",{scope:"col",className:"text-nowrap",children:"cluster description "}),e("th",{scope:"col",className:"text-nowrap",children:"snomed code description"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:c.map((t,a)=>i("tr",{children:[e("th",{children:e(V,{type:"checkbox",id:`department-${t.id}-${a}`,checked:m.includes(t.id),onChange:n=>xe(n,t.id),disabled:""})}),e("td",{className:"text-nowrap cursor-pointer",children:t.id?t.id:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.db_type!==null?t.db_type:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.cluster_id?t.cluster_id:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code?t.snomed_code:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.output_id?t.output_id:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.output_description?t.output_description:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.pcd_refset_id!==null?t.pcd_refset_id:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.cluster_description?t.cluster_description:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code_description?t.snomed_code_description:"---"}),e("td",{className:"text-right",onClick:()=>x(t.id),children:Se(t)})]},a))})]}):e(K,{children:e(Ne,{color:"danger",msg:"No results found!"})})}):e(K,{children:e(je,{})}),c.length>1&&e(Re,{pages:_,action:q,disabled:ee})]}),e(qe,{handleChangeSelect:be,open:z,handleModal:oe,getData:_e,getUnderWriter:ce,detail:ne,setDetail:P,updateAble:h,setUpdateAble:g,dId:u}),e(Be,{isLoading:he,centeredModal:A,setCenteredModal:O,onDelete:()=>ge()})]})}function ut(){return w.get(`${v}/api/department/`).then(c=>c.data).catch(c=>{throw c})}export{pt as default,ut as fetchData};
