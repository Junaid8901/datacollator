import{L as e,K as c,a2 as D,ai as K,a1 as be,r as l,aa as ne,V as re,a6 as te,ab as q}from"./index-3d883fcf.js";import{R as ge}from"./Row-5109e405.js";import{C as o}from"./Col-a2b04bb3.js";import{C as _e}from"./Card-592ff91e.js";import{C as G}from"./CardBody-936a8236.js";import{F as ve}from"./Form-3f6d3038.js";import{V as Ce,F as s,I as _,S as x,a2 as le,s as $,O as F,a3 as Se,a4 as M,m as Q,a5 as we,a6 as Ne,a7 as xe,D as $e,t as Fe,Z as ce,u as Me,k as De,a8 as ae,U as Ue,a9 as Be,v as Ie,aa as Oe,a0 as Re,b as Ae,R as Le}from"./App-5cbcf20f.js";import{F as oe}from"./index-fa6c4ee5.js";import{f as se,d as ke}from"./getCalenderData-9836b40c.js";import{a as ie}from"./apiStarts-aa5e83c1.js";import{A as Te}from"./AppCard-4a4dc868.js";import{T as ze}from"./Table-3067e42e.js";import{S as Ee,P as He}from"./Pagination-d99299e9.js";import{A as Ve}from"./AlertComponent-bf42c7e0.js";import{d as de}from"./TooltipControl-b72a6e51.js";import{a as je}from"./ToastComponent-8641b054.js";import"./moment-fbc5633a.js";import"./CardTitle-59b85a96.js";import"./Alert-a7a9f3c0.js";function Ke({searchParam:n,setSearchParam:d,handleList:m,isLoading:U,searchByName:h,searchByDealerNumber:O,searchByDealer:R,searchByModelGroup:Z,searchByUnderwritter:A,searchByVehicleType:J,searchByReinsurance:v,isDataLoaded:y,showWarning:C,searchBySR:L,searchByAgent:B,searchByMemberType:b,searchBymemberOf:W,searchByAdmin:k,remitType:p,searchByDealerMember:I,disabled:T,searchByStartDate:z,searchByEndDate:E,searchByMinPaid:g,searchByMaxPaid:H,searchByRecieptNumber:V,searchByCustomerType:a,searchByMember:u,mem:S,children:me,namePlaceholder:X,searchByDealerUnderwriter:pe,searchByModel:Qe,isClearable:j,payable:Ze,memberOf:ue,searchByMoneyMovemenet:he,searchByClipType:fe}){const t=Ce(p),ye=r=>{r.preventDefault(),m(!0,1)},f=r=>i=>{d({...n,[r]:i.target.value})},w=(r,i)=>{d({...n,[i]:r})},Y=(r,i)=>{d(i==="underwriter"||i==="reinsurance"?{...n,[i]:r,dealer:""}:{...n,[i]:r})},P=r=>i=>{const ee=i[0];console.log("date",ee),n[r]=ke(ee)},N=(r,i)=>{console.log("searchParam.member_type",n.member_type),console.log("e",r,"name",i),d({...n,[i]:r||"",overfund:"",misc_overfund:""})};return e(_e,{children:e(G,{children:e(ve,{onSubmit:r=>ye(r),children:c(ge,{children:[h&&e(o,{md:"3",children:e(s,{children:e(_,{type:"search",value:n.name,onChange:f("name"),placeholder:`Search by ${X||"name"}`,id:"search-by-name"})})}),O&&e(o,{md:"3",children:e(s,{children:e(_,{type:"search",value:n.dealer_number,onChange:f("dealer_number"),placeholder:"Search by dealer number",id:"search-by-dealer-number"})})}),z&&e(o,{md:"3",children:e(s,{children:e(oe,{onBlur:f("date_start"),placeholder:"From date",className:"form-control",value:n.date_start,onChange:P("date_start"),options:se})})}),E&&e(o,{md:"3",children:e(s,{children:e(oe,{onBlur:f("date_end"),value:n.date_end,placeholder:"To date",className:"form-control",onChange:P("date_end"),options:se})})}),g&&e(o,{md:"3",children:e(s,{children:e(_,{type:"search",id:"search-by-min-paid",placeholder:"Min paid",onChange:f("min_paid_amount"),value:n.min_paid_amount})})}),H&&e(o,{md:"3",children:e(s,{children:e(_,{type:"search",id:"search-by-max-paid",placeholder:"Max paid",onChange:f("max_paid_amount"),value:n.max_paid_amount})})}),V&&e(o,{md:"3",children:e(s,{children:e(_,{type:"search",id:"search-by-receipt-number",placeholder:"Receipt number",onChange:f("id"),value:n.od})})}),b&&e(o,{md:"3",children:e(s,{children:e(x,{placeholder:"Member type",id:"search-by-member-type",value:{label:n.member_type==="Dealer"?"Policy Holder":n.member_type&&n.member_type==="Underwriter"?"Insurance company":n.member_type},options:p==="misc-overfund"?[...le,"Underwriter","Reinsurance"]:le,theme:$,className:"react-select",classNamePrefix:"select",isClearable:!1,isSearchable:!1,onChange:r=>N(r,"member_type"),components:{Option:F}})})}),a&&e(o,{md:"3",children:e(s,{children:e(x,{placeholder:"Member type",id:"search-by-member-type",value:{label:n.customer_of},options:Se,theme:$,className:"react-select",classNamePrefix:"select",isClearable:!1,isSearchable:!1,onChange:r=>N(r,"customer_of"),components:{Option:F}})})}),R&&e(o,{md:"3",children:e(s,{children:e(M,{getEmail:!0,value:n[t||"dealer"],childUrl:`${ie}dealer/`,parentFunction:w,placeholder:"Policy holder",name:t||"dealer",isClearable:!j})})}),ue&&e(o,{md:"3",children:e(_,{disabled:!0,placeholder:"Select memeber of"})}),Z&&e(o,{md:"3",children:e(s,{children:e(M,{value:n.model_group,childUrl:`${D}/api/company/${K}/model/group/`,parentFunction:w,placeholder:"Model group",name:"model_group"})})}),A&&e(o,{md:"3",children:e(s,{children:e(M,{value:n[t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"underwriter"],childUrl:`${D}/api/company/${K}/underwriter/`,parentFunction:p==="underwriter"?Y:w,isClearable:p&&!j,placeholder:t==="misc_overfund"?"Select Insurance company":"Insurance company",warningClass:C&&!y,name:t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"underwriter"})})}),v&&e(o,{md:"3",children:e(s,{children:e(M,{value:n[t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"reinsurance"],childUrl:`${D}/api/company/${K}/reinsurance/`,parentFunction:p==="reinsurance"?Y:w,isClearable:p&&!j,placeholder:t==="misc_overfund"?"Select reinsurance":"Reinsurance",name:t==="misc_overfund"||t==="admin_fee"||t==="overfund"?t:"reinsurance",warningClass:C&&!y})})}),pe&&e(o,{md:"6",children:e(s,{children:e(M,{reload:n.underwriter||n.reinsurance,value:n.dealer,childUrl:`${ie}dealer/`,parentFunction:w,placeholder:Q("Dealer"),showWarning:C,name:"dealer",multi:!0,underwriter:t==="underwriter",reinsurance:t==="reinsurance",reinsuranceId:n.reinsurance?n.reinsurance.id:"",underwriterId:n.underwriter?n.underwriter.id:""})})}),J&&e(o,{md:"3",children:e(s,{children:e(x,{placeholder:"Vehicle type",id:"search-by-vehicle-type",value:{label:n.vehicle_type?n.vehicle_type:"Select vehicle type"},options:we,theme:$,className:"react-select",classNamePrefix:"select",isClearable:!0,isSearchable:!1,onChange:r=>N(r,"vehicle_type"),components:{Option:F}})})}),he&&e(o,{md:"3",children:e(s,{children:e(x,{placeholder:"Money movement enabled",id:"search-by-enable-money-movement",value:{label:n.enable_money_movement?n.enable_money_movement:"Select money movement enabled"},options:Ne,theme:$,className:"react-select",classNamePrefix:"select",isClearable:!0,isSearchable:!1,onChange:r=>N(r,"enable_money_movement"),components:{Option:F}})})}),fe&&e(o,{md:"3",children:e(s,{children:e(x,{placeholder:"Clip type",id:"search-by-clip-type",value:{label:n.clip_type?n.clip_type:"Select clip type"},options:xe,theme:$,className:"react-select",classNamePrefix:"select",isClearable:!0,isSearchable:!1,onChange:r=>N(r,"clip_type"),components:{Option:F}})})}),c(o,{md:"3",children:[c($e,{type:"submit",id:"search-btn",outline:!0,disabled:U||T,children:[U?e(be,{size:"sm"}):e(Fe,{size:15})," ","Search"]}),me]})]})})})})}function qe(){const{roleType:n}=ce(),d=Me(),[m,U]=l.useState({page:1,name:""}),[h,O]=l.useState("");l.useState(!1);const[R,Z]=l.useState(!1),[A,J]=l.useState(!1),[v,y]=l.useState(!1),[C,L]=l.useState(!1);l.useState(""),l.useState([]),l.useState(""),l.useState(!1),l.useState(!1);const[B,b]=l.useState(!1),[W,k]=l.useState(!1);l.useState([]);const[p,I]=l.useState(!1),T=()=>{d.push(`/${n}-roles/add`)},z=()=>`${D}/api/role/`,E=a=>`?page=${a||m.page}${m.name&&`&name=${m.name}`}`,g=(a,u)=>{a?b(!0):a&&u?(b(!0),setQueryParams({...queryParams,page:u})):!a&&!u&&I(!1),re.get(z()+E(u),te).then(S=>{console.log("res",S),O(S.data),b(!1),I(!0)}).catch(S=>{console.log("e",S),b(!1),I(!0)})},H=a=>c(l.Fragment,{children:[e(l.Fragment,{children:R&&A.id===a?e(Spinner,{size:"sm",color:"primary",className:"ml-1"}):e(de,{target:`edit-${a}`,Icon:Oe,title:"Edit",action:()=>{d.push(`/${n}-roles/edit/${a}`)}})}),e(de,{target:`delete-${a}`,Icon:Re,title:"Delete",action:()=>{L(a),y(!v)}})]}),V=a=>{k(!0),re.delete(`${D}/api/role/${C}/`,te).then(u=>{je("error",Ae,"Successfully deleted"),y(!v),g(),k(!1)})};return l.useEffect(()=>{g()},[window.location.href]),c(l.Fragment,{children:[e(Ke,{searchByName:!0,searchParam:m,setSearchParam:U,handleList:g,isLoading:B}),e(Te,{title:`${Q(n)} roles`,button:`${Q(n)} roles`,onClick:()=>T(),children:p?e(l.Fragment,{children:h&&h.results.length?c(l.Fragment,{children:[e(De,{blocking:B,children:c(ze,{responsive:!0,children:[e("thead",{children:c("tr",{children:[e("th",{scope:"col",className:"text-nowrap",children:"id"}),e("th",{scope:"col",className:"text-nowrap",children:"Name"}),e("th",{scope:"col",className:"text-nowrap",children:"Permissions"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:h.results.map((a,u)=>c("tr",{children:[e("td",{className:"text-nowrap",children:ae(a.id)}),c("td",{className:"text-nowrap",children:[e(ne,{pill:!0,color:"light-primary",children:e(Ue,{size:20})})," ",ae(a.name)]}),c("td",{className:"text-nowrap",children:[e(ne,{pill:!0,color:"light-success",children:e(Be,{size:20})})," ",a.permissions]}),e("td",{className:"text-right",onClick:()=>L(a.id),children:H(a.id)})]},u))})]})}),h.total_pages>1&&e(He,{action:g,pages:h,disabled:B})]}):e(G,{children:e(Ve,{color:"danger",msg:"No results found!"})})}):e(G,{children:e(Ee,{})})}),e(Ie,{isLoading:W,centeredModal:v,setCenteredModal:y,onDelete:()=>V()})]})}function Ge({children:n,permission:d}){const m=()=>q?q&&q.includes(d)?n:e(Le,{to:"/misc/not-authorized"}):n;return e(l.Fragment,{children:m()})}function fn(){const{roleType:n}=ce(),d=()=>{if(n==="administrator")return"view_companyrole"};return e(l.Fragment,{children:e(Ge,{permission:d(),children:e(qe,{})})})}export{fn as default};
