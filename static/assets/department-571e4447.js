import{r as s,G as me,J as c,K as e,a0 as Q,B as X,a6 as Te,U as w,a1 as x,a5 as U,af as ue}from"./index-a78e1d6d.js";import{S as Ae,A as Ie}from"./SkeletonComponent-fa92aef4.js";import{C as fe}from"./Card-d18638bb.js";import{C as Z}from"./CardBody-d3a746c0.js";import{M as _e,i as ge,j as Se,F as b,k as ee,C as E,n as he,I as te,X as Ue,S as Ee,m as Be,o as Oe}from"./App-efc1b7be.js";import{T as Re}from"./Table-425d6904.js";import{U as ze}from"./index-bfeadac6.js";import{T as He}from"./TooltipControl-f0c53da5.js";import{I as j}from"./Input-c0987a3f.js";import{L as se}from"./Label-04986467.js";/* empty css                  */import{A as G}from"./AdminButton-84e07a20.js";import"./SearchField-07902b43.js";import{a as y}from"./ToastComponent-995c97dd.js";import{M as qe}from"./ModalForDelete-2d2637c0.js";import"./react-paginate-533e7335.js";import{q as N}from"./index-d3b2d275.js";import{R as Ge}from"./Row-7b588485.js";import{C as M}from"./Col-71b6a57a.js";import{F as Ve}from"./Form-5abcf6ba.js";import{P as Je}from"./Pagination-df789667.js";import{S as Ke}from"./SingleAsyncPagination-8de520fc.js";import"./Alert-123a8cd6.js";import"./index-b9dfdea5.js";const Xe=({open:i,handleModal:h,detail:f,setDetail:p,updateAble:P,setUpdateAble:u,getUnderWriter:T,handleChangeSelect:_})=>{const[v,r]=s.useState(!1),[B,l]=s.useState([]);me();const k=()=>{p(S=>({...S,active:!S.active}))},O=S=>{S.preventDefault(),r(!0);const C={...f};Te.is_super_admin||delete C.external_admin,w.post(`${x}/api/department/`,C,U).then(g=>{r(!1),T(),h(),y("success",E,"Successfully added")}).catch(g=>{if(r(!1),g&&g.response.status===400)for(const[L,o]of Object.entries(g.response.data))l(J=>J.concat(L)),y("error",te,`${he(L)}: ${o}`)})},R=S=>{l([]),S.preventDefault(),r(!0);const C={...f};w.put(`${x}/api/department/${f.id}/`,C,U).then(g=>{r(!1),h(),T(),y("success",E,"Successfully updated"),setTimeout(()=>{window.location.reload()},1e3)}).catch(g=>{if(r(!1),g&&g.response.status===400)for(const[L,o]of Object.entries(g.response.data))l(J=>J.concat(L)),y("error",te,`${he(L)}: ${o}`)})};s.useEffect(()=>{},[]);const D=()=>{p({name:""}),u(!1),u(!1),l([])},V=S=>C=>{l([]),p({...f,[S]:C.target.value})};return c(_e,{isOpen:i,onClosed:D,toggle:h,className:"sidebar-lg",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e(ge,{className:"mb-1",toggle:h,close:e(Ue,{className:"cursor-pointer",size:15,onClick:h}),tag:"div",children:e("h5",{className:"modal-title",children:P?"Update Department":"Add New Department"})}),c(Se,{className:"flex-grow-1",children:[c(b,{children:[e(se,{for:"name",children:"Department Name"}),e(j,{invalid:B.includes("name"),id:"name",placeholder:"Name",value:f.name,onChange:V("name")})]}),e(b,{children:e(ee,{checked:f.active,type:"checkbox",label:"Active",id:"select-all",onChange:()=>k()})}),c(G,{className:"mr-1",color:"primary",disabled:v,onClick:P?R:O,children:[P?"Update":"Submit"," ",v&&e(Q,{color:"light",size:"sm"})]}),e(X,{color:"secondary",onClick:h,outline:!0,disabled:v,children:"Cancel"})]})]})};function Qe({checkType:i,userType:h,setSearchParams:f,searchParams:p,memberArrange:P,searching:u,handleList:T,children:_,handleChangeSelectDbType:v}){const r=l=>k=>{f({...p,[l]:k.target.value})},B=l=>{l.preventDefault(),T(1,!0,"search")};return e(s.Fragment,{children:e(fe,{children:e(Z,{children:e(Ve,{onSubmit:l=>B(l),children:c(Ge,{children:[e(M,{md:"3",children:e(b,{children:e(j,{placeholder:"cluster id",onChange:r("cluster_id"),value:p.cluster_id})})}),e(M,{md:"3",children:e(b,{children:e(j,{placeholder:"pcd refset id",onChange:r("pcd_refset_id"),value:p.pcd_refset_id})})}),e(M,{md:"3",children:e(b,{children:e(j,{placeholder:"ruleset_id",onChange:r("ruleset_id"),value:p.ruleset_id})})}),e(M,{md:"3",children:e(b,{children:e(j,{placeholder:"cluster_description",onChange:r("cluster_description"),value:p.cluster_description})})}),e(M,{md:"3",children:e(b,{children:e(j,{type:"number",placeholder:"snomed_code",onChange:r("snomed_code"),value:p.snomed_code})})}),e(M,{md:"3",children:e(b,{children:e(j,{placeholder:"snomed_code_description",onChange:r("snomed_code_description"),value:p.snomed_code_description})})}),e(M,{md:"3",children:e(b,{children:e(j,{placeholder:"output id",onChange:r("output_id"),value:p.output_id})})}),e(M,{md:"3",children:c(b,{children:[c(G,{outline:!0,type:"submit",disabled:u,children:[u?e(Q,{size:"sm"}):e(Ee,{size:15})," ","Search"]}),_]})})]})})})})})}function We({open:i,setOpen:h,agreementError:f,handleCreate:p,handleUpdate:P,checkDisabled:u,dealerEmail:T,handleChange:_,setValue:v,value:r,CreateProjectHandleModal:B,UpdateProjectHandleModal:l,handleChangeSelect:k,selectProject:O,buttonName:R}){return c(_e,{isOpen:i,centered:!0,toggle:()=>h(!1),children:[e(ge,{toggle:()=>h(!1),children:e("h5",{className:"m-0",children:"Project"})}),e(Se,{children:O===1?c(s.Fragment,{children:[" ",e(se,{children:"Project Name"}),e(j,{type:"text",value:r.name,onChange:_("name")})]}):c(s.Fragment,{children:[e(se,{children:"Select Project"}),e(Ke,{url:`${x}/api/pcd-projects/`,selector:"project_name",projectName:"project_name",parentFunction:D=>k("project_name",D),value:r.project_name})]})}),c(Be,{children:[e(X,{outline:!0,disabled:u,onClick:()=>h(!1),children:"Cancel"}),O===1?c(X,{outline:!0,color:"info",disabled:u,onClick:()=>B(),children:[R||"Create",u&&e(Q,{size:"sm"})]}):c(X,{outline:!0,color:"info",disabled:u,onClick:()=>l(),children:["Update ",u&&e(Q,{size:"sm"})]})]})]})}function wt(){const[i,h]=s.useState([]),[f,p]=s.useState([]),[P,u]=s.useState(!1),[T,_]=s.useState(!1),[v,r]=s.useState(!1),[B,l]=s.useState(!1),[k,O]=s.useState(""),[R,D]=s.useState(!1),[V,W]=s.useState(!1),[S,C]=s.useState([]),[g,L]=s.useState(!1),[o,J]=s.useState([]),[ae,Ye]=s.useState(!1),[F,Ze]=s.useState([]),[m,z]=s.useState(!1),[Ce,A]=s.useState(!1),[I,ne]=s.useState(1),[$e,oe]=s.useState(),[$,q]=s.useState({name:"",project_name:" "}),[et,ce]=s.useState([]);s.useState(1),s.useState(1),s.useState(!1),s.useState(!0),s.useState("");const[d,re]=s.useState({page:N("page"),cluster_id:N("cluster_id"),pcd_refset_id:N("pcd_refset_id"),ruleset_id:N("ruleset_id"),snomed_code:N("snomed_code"),db_type:N("db_type"),snomed_code_description:N("snomed_code_description"),cluster_description:N("cluster_description"),output_id:N("output_id")}),[be,Y]=s.useState({name:"",active:!1}),xe=t=>(console.log("page",d),`${`&cluster_id=${d.cluster_id?d.cluster_id:""}`}${`&pcd_refset_id=${d.pcd_refset_id?d.pcd_refset_id:""}`}${`&ruleset_id=${d.ruleset_id?d.ruleset_id:""}`}${`&snomed_code=${d.snomed_code?d.snomed_code:""}`}${`&db_type=${d.db_type?d.db_type:""}`}${`&snomed_code_description=${d.snomed_code_description?d.snomed_code_description:""}`}${`&cluster_description=${d.cluster_description?d.cluster_description:""}`}${`&output_id=${d.output_id?d.output_id:""}`}`),ye=t=>a=>{q({...$,[t]:a.target.value})},Ne=t=>a=>{re({...d,[t]:a});const n=err.filter(H=>H!==t);setErr(n)};me();const de=(t,a)=>{C(a),_(!0),w.get(`${x}/api/pcdrefset/?page=${I}`,U).then(n=>{console.log("navigationData",n),_(!1),h(n.data.results),C(n.data.results[0].db_type),u(!0),D(!1),K()}).catch(n=>{u(!0),_(!1),ne(H=>H-1)})},K=t=>{ne(t),_(!0),w.get(`${x}/api/pcdrefset/?page=${t||1}${xe()}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${ue}`}}).then(a=>{_(!1),h(a.data.results),p(a.data),C(a.data.results[0].db_type),u(!0),D(!1),ce([]);for(let n=0;n<a.data.total_pages;++n)ce(H=>H.concat(n+1))}).catch(()=>{_(!1)})};s.useEffect(()=>{K()},[]);const we=t=>{Y({id:t}),l(!0),w.get(`${x}/api/department/${t}/`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${ue}`}}).then(a=>{l(!1),Y({...a.data}),r(!v),D(!0)}).catch(()=>{l(!1)})},je=()=>{L(!0),w.delete(`${x}/api/department/${k}/`,U).then(t=>{y("error",te,"Successfully Deleted"),W(!V),L(!1),de()})},ve=t=>e(s.Fragment,{children:e(He,{target:`detail-${t.id}`,Icon:Oe,title:"Detail",navLink:`/detail/${S}/${t.id}`})}),le=(t,a)=>{q({...$,[t]:a})},ie=()=>{console.log("selectedRows",o);const t={pcd_ids:o,source:"pcd_data"};w.post(`${x}/api/exported/`,t,U).then(a=>{y("success",E,"Successfully export")}).catch(a=>{})},ke=()=>{A(!0),oe(1)},De=()=>{A(!0),oe(2)},Le=()=>{if(A(!0),console.log("selectedRows",o),!$.name)y("error",E,"Enter project name");else{const t={pcd_refsets:o,project_name:$.name};w.post(`${x}/api/pcd-projects/`,t,U).then(a=>{A(!1),y("success",E,"Successfully create"),q({...$,name:""})}).catch(a=>{})}};console.log("selectedRows",$);const Fe=()=>{A(!0);const t={pcd_refsets:o,project_name:$.project_name.project_name},a=$.project_name.id;a?w.put(`${x}/api/pcd-projects/${a}/`,t,U).then(n=>{A(!1),q({...$,project_name:""}),y("success",E,"Successfully update")}).catch(n=>{}):y("error",E,"select project ")};s.useEffect(()=>{},[]);const Me=()=>{const t=[],a=[];if(F.includes(I)){F.splice(F.indexOf(I),1);for(let n=0;n<i.length;n++)a.push(parseFloat(i[n].amount)),o.splice(o.indexOf(i[n].id),1);z({...m,tester:m}),subAllHandler(a),z({...m,tester:m})}else{F.push(I);for(let n=0;n<i.length;n++)o.includes(i[n].id)||(t.push(parseFloat(i[n].amount)),o.push(i[n].id));z({...m,tester:m}),z({...m,tester:m})}},Pe=(t,a,n)=>{t.target.checked?(o.push(a),z({...m,tester:m})):(o.splice(o.indexOf(a),1),F.includes(I)&&F.splice(F.indexOf(I),1),z({...m,tester:m}))},pe=t=>{const a=t.length>70?`${t.slice(0,70)}.......`:t;return a.slice(9),a};return c(s.Fragment,{children:[e(Qe,{setSearchParams:re,searchParams:d,searching:ae,handleList:K,handleChangeSelectDbType:Ne}),c(fe,{children:[c("div",{className:"d-flex align-items-center justify-content-between p-1",children:[e("div",{children:e("h3",{className:"m-0",children:"Pcd Data "})}),c("div",{children:[e(G,{onClick:ke,disabled:o.length===0,children:"Create Project"})," ",e(G,{onClick:De,disabled:o.length===0,children:"Update Project"})," ",e(G,{onClick:ie,disabled:o.length===0,children:"Export"})]})]}),P?e(ze,{blocking:T,children:i.length?c(Re,{responsive:!0,children:[e("thead",{children:c("tr",{children:[e("th",{className:"text-nowrap",children:e(ee,{type:"checkbox",id:"invoice-select-all",label:"",checked:F.includes(I),onChange:t=>Me()})}),e("th",{scope:"col",className:"text-nowrap",children:"id"})," ",e("th",{scope:"col",className:"text-nowrap w",children:"db type "})," ",e("th",{scope:"col",className:"text-nowrap",children:"cluster id"}),e("th",{scope:"col",className:"text-nowrap",children:"snomed code"}),e("th",{scope:"col",className:"text-nowrap",children:"Output id"}),e("th",{scope:"col",className:"text-nowrap",children:"output description"}),e("th",{scope:"col",className:"text-nowrap",children:"pcd refset id"}),e("th",{scope:"col",className:"text-nowrap",children:"cluster description "}),e("th",{scope:"col",className:"text-nowrap",children:"snomed code description"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:i.map((t,a)=>c("tr",{children:[e("th",{children:e(ee,{type:"checkbox",id:`department-${t.id}-${a}`,checked:o.includes(t.id),onChange:n=>Pe(n,t.id),disabled:""})}),e("td",{className:"text-nowrap cursor-pointer",children:t.id?t.id:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.db_type!==null?t.db_type:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.cluster_id?t.cluster_id:"---"})," ",e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code?t.snomed_code:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.output_id?t.output_id:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.output_description?t.output_description:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.pcd_refset_id!==null?t.pcd_refset_id:"---"}),e("td",{className:"text-nowrap cursor-pointer ",children:t.cluster_description?pe(t.cluster_description):"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code_description?pe(t.snomed_code_description):"---"}),e("td",{className:"text-right",onClick:()=>O(t.id),children:ve(t)})]},a))})]}):e(Z,{children:e(Ie,{color:"danger",msg:"No results found!"})})}):e(Z,{children:e(Ae,{})}),i.length>1&&e(Je,{pages:f,action:K,disabled:ae})]}),e(Xe,{handleChangeSelect:le,open:v,handleModal:ie,getData:we,getPcdData:de,detail:be,setDetail:Y,updateAble:R,setUpdateAble:D,dId:k}),e(We,{open:Ce,setOpen:A,handleChange:ye,setValue:q,value:$,CreateProjectHandleModal:Le,UpdateProjectHandleModal:Fe,handleChangeSelect:le,selectProject:$e}),e(qe,{isLoading:g,centeredModal:V,setCenteredModal:W,onDelete:()=>je()})]})}export{wt as default};
