import{K as e,J as o,a0 as se,r,a9 as H,U as O,a5 as E,a1 as K,aa as _}from"./index-a78e1d6d.js";import{R as oe}from"./Row-7b588485.js";import{C as h}from"./Col-71b6a57a.js";import{C as ne}from"./Card-d18638bb.js";import{C as $}from"./CardBody-d3a746c0.js";import{F as le}from"./Form-5abcf6ba.js";import{z as ie,F as B,K as ce,Z as W,$ as de,a0 as me,S as he,P as Y,u as pe,a1 as j,a2 as G,U as ue,a3 as fe,Y as ye,V as ge,I as be,R as Se}from"./App-efc1b7be.js";import{I as V}from"./Input-c0987a3f.js";import"./SearchField-07902b43.js";import{A as Ce}from"./AdminButton-84e07a20.js";/* empty css                  */import{F as q}from"./index-56d211b1.js";import{f as J,d as Be}from"./getCalenderData-9836b40c.js";import{A as Ne}from"./AppCard-5dd622ab.js";import{T as we}from"./Table-425d6904.js";import{S as De,A as Me}from"./SkeletonComponent-fa92aef4.js";import{a as Q}from"./TooltipControl-f0c53da5.js";import{M as xe}from"./ModalForDelete-2d2637c0.js";import{a as Fe}from"./ToastComponent-995c97dd.js";import{U as _e}from"./index-bfeadac6.js";import{P as $e}from"./Pagination-df789667.js";import"./index-b9dfdea5.js";import"./moment-fbc5633a.js";import"./CardTitle-4fff166c.js";import"./Alert-123a8cd6.js";import"./react-paginate-533e7335.js";function ve({searchParam:t,setSearchParam:n,handleList:l,isLoading:f,searchByName:c,searchByDealerNumber:v,searchByDealer:U,searchByModelGroup:Z,searchByUnderwritter:T,searchByVehicleType:X,searchByReinsurance:y,isDataLoaded:g,showWarning:R,searchBySR:N,searchByAgent:b,searchByMemberType:d,searchBymemberOf:A,searchByAdmin:w,remitType:S,searchByDealerMember:C,disabled:D,searchByStartDate:M,searchByEndDate:x,searchByMinPaid:p,searchByMaxPaid:I,searchByRecieptNumber:L,searchByCustomerType:a,searchByMember:i,mem:u,children:ee,namePlaceholder:k,searchByDealerUnderwriter:Re,searchByModel:Ae,isClearable:Ie,payable:Le,memberOf:re,searchByMoneyMovemenet:ke,searchByClipType:ze}){ie(S);const te=s=>{s.preventDefault(),l(!0,1)},F=s=>m=>{n({...t,[s]:m.target.value})},z=s=>m=>{const P=m[0];console.log("date",P),t[s]=Be(P)},ae=(s,m)=>{console.log("searchParam.member_type",t.member_type),console.log("e",s,"name",m),n({...t,[m]:s||"",overfund:"",misc_overfund:""})};return e(ne,{children:e($,{children:e(le,{onSubmit:s=>te(s),children:o(oe,{children:[c&&e(h,{md:"3",children:e(B,{children:e(V,{type:"search",value:t.name,onChange:F("name"),placeholder:`Search by ${k||"name"}`,id:"search-by-name"})})}),M&&e(h,{md:"3",children:e(B,{children:e(q,{onBlur:F("date_start"),placeholder:"From date",className:"form-control",value:t.date_start,onChange:z("date_start"),options:J})})}),x&&e(h,{md:"3",children:e(B,{children:e(q,{onBlur:F("date_end"),value:t.date_end,placeholder:"To date",className:"form-control",onChange:z("date_end"),options:J})})}),d&&e(h,{md:"3",children:e(B,{children:e(ce,{placeholder:"Member type",id:"search-by-member-type",value:{label:t.member_type==="Dealer"?"Policy Holder":t.member_type&&t.member_type==="Underwriter"?"Insurance company":t.member_type},options:S==="misc-overfund"?[...W,"Underwriter","Reinsurance"]:W,theme:de,className:"react-select",classNamePrefix:"select",isClearable:!1,isSearchable:!1,onChange:s=>ae(s,"member_type"),components:{Option:me}})})}),re&&e(h,{md:"3",children:e(V,{disabled:!0,placeholder:"Select memeber of"})}),o(h,{md:"3",children:[o(Ce,{type:"submit",id:"search-btn",outline:!0,disabled:f||D,children:[f?e(se,{size:"sm"}):e(he,{size:15})," ","Search"]}),ee]})]})})})})}function Ue(){const{roleType:t}=Y(),n=pe(),[l,f]=r.useState({page:1,name:""}),[c,v]=r.useState("");r.useState(!1);const[U,Z]=r.useState(!1),[T,X]=r.useState(!1),[y,g]=r.useState(!1),[R,N]=r.useState(!1);r.useState(""),r.useState([]),r.useState(""),r.useState(!1),r.useState(!1);const[b,d]=r.useState(!1),[A,w]=r.useState(!1);r.useState([]);const[S,C]=r.useState(!1),D=()=>{n.push(`/${t}-roles/add`)},M=()=>`${K}/api/role/`,x=a=>`?page=${a||l.page}${l.name&&`&name=${l.name}`}`,p=(a,i)=>{a?d(!0):a&&i?(d(!0),setQueryParams({...queryParams,page:i})):!a&&!i&&C(!1),O.get(M()+x(i),E).then(u=>{console.log("res",u),v(u.data),d(!1),C(!0)}).catch(u=>{console.log("e",u),d(!1),C(!0)})},I=a=>o(r.Fragment,{children:[e(r.Fragment,{children:U&&T.id===a?e(Spinner,{size:"sm",color:"primary",className:"ml-1"}):e(Q,{target:`edit-${a}`,Icon:ye,title:"Edit",action:()=>{n.push(`/${t}-roles/edit/${a}`)}})}),e(Q,{target:`delete-${a}`,Icon:ge,title:"Delete",action:()=>{N(a),g(!y)}})]}),L=a=>{w(!0),O.delete(`${K}/api/role/${R}/`,E).then(i=>{Fe("error",be,"Successfully deleted"),g(!y),p(),w(!1)})};return r.useEffect(()=>{p()},[window.location.href]),o(r.Fragment,{children:[e(ve,{searchByName:!0,searchParam:l,setSearchParam:f,handleList:p,isLoading:b}),e(Ne,{title:`${j(t)} roles`,button:`${j(t)} roles`,onClick:()=>D(),children:S?e(r.Fragment,{children:c&&c.results.length?o(r.Fragment,{children:[e(_e,{blocking:b,children:o(we,{responsive:!0,children:[e("thead",{children:o("tr",{children:[e("th",{scope:"col",className:"text-nowrap",children:"id"}),e("th",{scope:"col",className:"text-nowrap",children:"Name"}),e("th",{scope:"col",className:"text-nowrap",children:"Permissions"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:c.results.map((a,i)=>o("tr",{children:[e("td",{className:"text-nowrap",children:G(a.id)}),o("td",{className:"text-nowrap",children:[e(H,{pill:!0,color:"light-primary",children:e(ue,{size:20})})," ",G(a.name)]}),o("td",{className:"text-nowrap",children:[e(H,{pill:!0,color:"light-success",children:e(fe,{size:20})})," ",a.permissions]}),e("td",{className:"text-right",onClick:()=>N(a.id),children:I(a.id)})]},i))})]})}),c.total_pages>1&&e($e,{action:p,pages:c,disabled:b})]}):e($,{children:e(Me,{color:"danger",msg:"No results found!"})})}):e($,{children:e(De,{})})}),e(xe,{isLoading:A,centeredModal:y,setCenteredModal:g,onDelete:()=>L()})]})}function Te({children:t,permission:n}){const l=()=>_?_&&_.includes(n)?t:e(Se,{to:"/misc/not-authorized"}):t;return e(r.Fragment,{children:l()})}function mr(){const{roleType:t}=Y(),n=()=>{if(t==="administrator")return"view_companyrole"};return e(r.Fragment,{children:e(Te,{permission:n(),children:e(Ue,{})})})}export{mr as default};
