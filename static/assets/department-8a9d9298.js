import{r as a,M as ce,ad as H,P as o,F as e,a5 as T,B as le,ab as we,Y as N,a6 as C,aa as M,ap as L,as as ee,I as W,ao as te,Q as E}from"./index-52a95e7f.js";import{A as xe}from"./AlertComponent-c62e0952.js";import{R as be}from"./Row-9c9cf5c4.js";import{C as R}from"./Col-ea297bd2.js";import{C as ae,a as se}from"./CardBody-2b451391.js";import{T as Se}from"./Table-e685a4c1.js";import{S as ye,T as Oe}from"./TooltipControl-dabfa0ac.js";import{M as ve,k as Le,n as $e,F as ne,I as ke,o as Ie,D as q,C as oe,X as Be,q as re,i as Te,p as Me,r as Ae}from"./App-a255ea7a.js";import{L as Pe}from"./Label-e92a3cb1.js";import{P as Fe}from"./PaginationComponent-fc5caf5a.js";import"./Alert-9a31d8ac.js";const je=({open:h,handleModal:d,detail:f,setDetail:D,updateAble:u,setUpdateAble:_,getUnderWriter:$,handleChangeSelect:A})=>{const[b,p]=a.useState(!1),[P,r]=a.useState([]),w=ce(),k=()=>{D(c=>({...c,active:!c.active}))},G=c=>{c.preventDefault(),p(!0);const m={...f};we.is_super_admin||delete m.external_admin,N.post(`${C}/api/department/`,m,M).then(l=>{w(H()),p(!1),$(),d(),L("success",oe,"Successfully added")}).catch(l=>{if(p(!1),l&&l.response.status===400)for(const[s,g]of Object.entries(l.response.data))r(y=>y.concat(s)),L("error",W,`${ee(s)}: ${g}`)})},S=c=>{r([]),c.preventDefault(),p(!0);const m={...f};N.put(`${C}/api/department/${f.id}/`,m,M).then(l=>{p(!1),d(),$(),L("success",oe,"Successfully updated"),setTimeout(()=>{window.location.reload()},1e3)}).catch(l=>{if(p(!1),l&&l.response.status===400)for(const[s,g]of Object.entries(l.response.data))r(y=>y.concat(s)),L("error",W,`${ee(s)}: ${g}`)})};a.useEffect(()=>{w(H())},[]);const I=()=>{D({name:""}),_(!1),_(!1),r([])},F=c=>m=>{r([]),D({...f,[c]:m.target.value})};return o(ve,{isOpen:h,onClosed:I,toggle:d,className:"sidebar-lg",modalClassName:"modal-slide-in",contentClassName:"pt-0",children:[e(Le,{className:"mb-1",toggle:d,close:e(Be,{className:"cursor-pointer",size:15,onClick:d}),tag:"div",children:e("h5",{className:"modal-title",children:u?"Update Department":"Add New Department"})}),o($e,{className:"flex-grow-1",children:[o(ne,{children:[e(Pe,{for:"name",children:"Department Name"}),e(ke,{invalid:P.includes("name"),id:"name",placeholder:"Name",value:f.name,onChange:F("name")})]}),e(ne,{children:e(Ie,{checked:f.active,type:"checkbox",label:"Active",id:"select-all",onChange:()=>k()})}),o(q,{className:"mr-1",color:"primary",disabled:b,onClick:u?S:G,children:[u?"Update":"Submit"," ",b&&e(T,{color:"light",size:"sm"})]}),e(le,{color:"secondary",onClick:d,outline:!0,disabled:b,children:"Cancel"})]})]})};function Ve(){const[h,d]=a.useState([]),[f,D]=a.useState(!1),[u,_]=a.useState(!1),[$,A]=a.useState(!1),[b,p]=a.useState(!1),[P,r]=a.useState(!1),[w,k]=a.useState(!1),[G,S]=a.useState(!1),[I,F]=a.useState(""),[Q,c]=a.useState(!1),[m,l]=a.useState(!1),[s,g]=a.useState([]),[y,X]=a.useState(!1),[ie,B]=a.useState(1),[Y,J]=a.useState([]),[de,K]=a.useState(1),[ue,V]=a.useState(1),[ze,j]=a.useState(!1),[Ue,z]=a.useState(!0);a.useState(""),a.useState({page:re("page"),name:re("name")});const[U,O]=a.useState({name:"",active:!1}),pe=ce(),x=(t,n)=>{t&&n==="Content"&&_(!0),t&&n==="Content_By_Output"&&A(!0),t&&n==="Output_Description"&&p(!0),g(n),r(!0),N.get(`${C}/api/pcdrefset/?db_type=${n||"Output_Description"}`,M).then(i=>{console.log("navigationData",i),_(!1),A(!1),p(!1),r(!1),d(i.data.results),g(i.data.results[0].db_type),D(!0),c(!1),B(1),J([]);for(let v=0;v<i.data.total_pages;++v)J(De=>De.concat(v+1));K(i.data.page_number+1),V(i.data.page_number-1),i.data.to===i.data.count?(j(!0),z(!1)):i.data.from===1?(j(!1),z(!0)):(j(!1),z(!1))}).catch(i=>{D(!0),r(!1),B(v=>v-1)})};a.useEffect(()=>{pe(H())},[]);const me=t=>{B(t),r(!0),N.get(`${C}/api/pcdrefset/?db_type=${s}&page=${t}`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${te}`}}).then(n=>{_(!1),r(!1),d(n.data.results),g(n.data.results[0].db_type),B(n.data.page_number),K(n.data.page_number+1),V(n.data.page_number-1)}).catch(()=>{_(!1),r(!1)})},he=t=>{O({id:t}),S(!0),N.get(`${C}/api/department/${t}/`,{headers:{"Content-Type":"application/json",Authorization:`Bearer ${te}`}}).then(n=>{S(!1),O({...n.data}),k(!w),c(!0)}).catch(()=>{S(!1)})},fe=()=>{X(!0),N.delete(`${C}/api/department/${I}/`,M).then(t=>{L("error",W,"Successfully Deleted"),l(!m),X(!1),x()})},_e=t=>e(a.Fragment,{children:e(Oe,{target:`detail-${t.id}`,Icon:Ae,title:"Detail",navLink:`/detail/${s}/${t.id}`})}),ge=(t,n)=>{O(t==="dwolla_account_type"?{...U,[t]:n.value,dwolla_customer_fs_id:"",dwolla_customer_id:"",dwolla_customer_account:"",dwolla_funding_source:""}:{...U,[t]:n})},Ne=()=>{k(!w)};a.useEffect(()=>{x()},[]);const Z=t=>t&&t.length>70?t&&t.slice(0,67)+".....":t,Ce=()=>e(ae,{className:"p-1",children:o(be,{children:[e(R,{sm:"4",children:o(le,{color:"primary",disabled:u,outline:!0,onClick:()=>x(!0,"Content"),className:"filebtn",children:["Content ",u&&e(T,{size:"sm",color:E})]})}),e(R,{sm:"4",children:o(q,{color:"primary",disabled:u,outline:!0,onClick:()=>x(!0,"Content_By_Output"),className:"filebtn",children:["Content By Output"," ",$&&e(T,{size:"sm",color:E})]})})," ",e(R,{sm:"4",children:o(q,{color:"primary",disabled:u,outline:!0,onClick:()=>x(!0,"Output_Description"),className:"filebtn",children:["Output Description"," ",b&&e(T,{size:"sm",color:E})]})})]})});return o(a.Fragment,{children:[Ce(),o(ae,{children:[e("div",{className:"d-flex align-items-center justify-content-between p-1",children:e("div",{children:e("h3",{className:"m-0",children:"Pcd Data "})})}),f?e(Te,{blocking:P,children:h.length?o(Se,{responsive:!0,children:[e("thead",{children:o("tr",{children:[s!=="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"cluster id"}),s==="Content_By_Output"&&e("th",{scope:"col",className:"text-nowrap",children:"Output id"}),s==="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"service id"}),s!=="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"snomed code"}),s!=="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"pcd refset id"}),e("th",{scope:"col",className:"text-nowrap",children:"db_type"}),s==="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"ruleset id"}),s!=="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"snomed code description"}),s==="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"output description"}),s==="Output_Description"&&e("th",{scope:"col",className:"text-nowrap",children:"Type"}),s==="Content"&&e("th",{scope:"col",className:"text-nowrap",children:"service ruleset"}),e("th",{scope:"col",className:"text-nowrap text-right",children:"Actions"})]})}),e("tbody",{children:h.map((t,n)=>o("tr",{children:[s!=="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.cluster_id?t.cluster_id:"---"}),s==="Content_By_Output"&&e("td",{className:"text-nowrap cursor-pointer",children:t.output_id?t.output_id:"---"}),s==="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.service_id?t.service_id:"---"}),s!=="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code?t.snomed_code:"---"}),s!=="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.pcd_refset_id!==null?t.pcd_refset_id:"---"}),e("td",{className:"text-nowrap cursor-pointer",children:t.db_type}),s==="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.ruleset_id?t.ruleset_id:"---"}),s!=="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.snomed_code_description}),s==="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:t.output_description}),s==="Output_Description"&&e("td",{className:"text-nowrap cursor-pointer",children:Z(t.type)}),s==="Content"&&e("td",{className:"text-nowrap cursor-pointer",children:Z(t.service_ruleset)}),e("td",{className:"text-right",onClick:()=>F(t.id),children:_e(t)})]},n))})]}):e(se,{children:e(xe,{color:"danger",msg:"No results found!"})})}):e(se,{children:e(ye,{})}),Y.length>1&&e(Fe,{pageList:Y,page:ie,next:de,prev:ue,paginate:me,isLoading:u})]}),e(je,{handleChangeSelect:ge,open:w,handleModal:Ne,getData:he,getUnderWriter:x,detail:U,setDetail:O,updateAble:Q,setUpdateAble:c,dId:I}),e(Me,{isLoading:y,centeredModal:m,setCenteredModal:l,onDelete:()=>fe()})]})}function Ze(){return N.get(`${C}/api/department/`).then(h=>h.data).catch(h=>{throw h})}export{Ve as default,Ze as fetchData};
